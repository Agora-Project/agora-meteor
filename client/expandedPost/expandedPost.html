<!--
    Agora Forum Software
    Copyright (C) 2016 Gregory Sartucci
    License: GPL, Check file LICENSE
-->

<template name="expandedPost">
    <div class="expanded-post">
        <a class="expanded-post-return-link" href="/forum/post/{{_id}}?view=forum">&laquo; Back to Forum</a>
        <h4 class="expanded-post-title">{{title}}</h4>
        <div class="expanded-post-info">
            {{#if user}}
                <a href="/forum/user/{{user._id}}">
                    {{> avatar user=(user) shape="rounded" class="expanded-post-avatar"}}
                </a>
                <a class="expanded-post-username" href="/forum/user/{{user._id}}">{{user.username}}</a>
            {{/if}}
            <span>{{age}}</span>
        </div>
        {{#if hasContent}}
            <p class="expanded-post-content">
                <!--
                This is where the posts content will be added, but that function is
                not performed here, it is carried out in expandedPost.js, in order
                to make the BBCode work properly.
                -->
            </p>
        {{/if}}

        {{> hourglassView this}}
    </div>
</template>

<template name="expandedPostNotFound">
    <h4 class="expanded-post-not-found">We're sorry! That post ({{_id}}) couldn't be found.</h4>
</template>

<template name="expandedPostLoading">
    <h4 class="expanded-post-loading">Loading...</h4>
</template>

<template name="hourglassView">
    <div class="overview-viewport" style="max-width:1024px;max-height: 568px">
        <div class="overview-centerer">
            {{#each displayedPost}}
                {{> hourglassPost}}
            {{/each}}
            <svg class="overview-links-graph"></svg>
            {{#each nodes}}
                {{> hourglassNode}}
            {{/each}}
        </div>
    </div>

</template>

<template name="hourglassNode">
    <a class="undraggable" href="/forum/post/{{_id}}">
        <div class="overview-node" id="overview-node-{{_id}}">
        </div>
    </a>
</template>

<template name="hourglassPost">
    <div class="post overview-post" id="overview-post-{{_id}}">
        <div class="overview-post-header">
            <a  href="/forum/post/{{_id}}">{{title}}</a>
        </div>
        <div class="overview-post-info">
            {{#if user}}
                <a href="/forum/user/{{user._id}}">
                    {{> avatar user=(user) size="small" shape="rounded" class="overview-avatar"}}
                </a>
                <a class="overview-username" href="/forum/user/{{user._id}}">
                    {{user.username}}
                </a>
            {{/if}}
            <span>
                {{age}}
            </span>
        </div>
        {{#if hasContent}}
            <div class="overview-post-content">
            </div>
        {{/if}}
    </div>
</template>
