<!--
    Agora Forum Software
    Copyright (C) 2016 Gregory Sartucci
    License: GPL, Check file LICENSE
-->

<template name="expandedPost">
    <div class="expanded-post">
        <a href="/forum/post/{{_id}}?view=forum">Forum</a>
        <h4 class="expanded-post-title">{{title}}</h4>
        <div class="expanded-post-info">
            {{#if user}}
                <a href="/forum/user/{{user._id}}">
                    {{> avatar user=(user) shape="rounded" class="expanded-post-avatar"}}
                </a>
                <a class="expanded-post-username" href="/forum/user/{{user._id}}">{{user.username}}</a>
            {{/if}}
            <span >{{age}}</span>
        </div>
        <p class="expanded-post-content">
            <!--
            This is where the posts content will be added, but that function is
            not performed here, it is carried out in expandedPost.js, in order
            to make the BBCode work properly.
            -->
        </p>

        {{> hourglassView this}}
    </div>
</template>

<template name="expandedPostNotFound">
    <h4 class="expanded-post-not-found">We're sorry! That post ({{_id}}) couldn't be found.</h4>
</template>

<template name="expandedPostLoading">
    <h4 class="expanded-post-loading">Loading...</h4>
</template>

<template name="hourglassView">
    <div class="hourglass-viewport">
        <div class="hourglass-centerer">
            {{#each postDisplay}}
                {{> hourglassPost}}
            {{/each}}
            <svg class="hourglass-links-graph"></svg>
            {{#each nodes}}
                {{> hourglassNode}}
            {{/each}}
        </div>
    </div>

</template>

<template name="hourglassNode">
    <a class="undraggable" href="/forum/post/{{_id}}">
        <div class="hourglass-node" id="hourglass-node-{{_id}}">
        </div>
    </a>
</template>

<template name="hourglassPost">
    <div class="post hourglass-post" id="post-{{_id}}">
        <div class="post-header">
            <div class="title-bar">
                <a  href="/forum/post/{{_id}}">{{title}}</a>
            </div>
        </div>
        <div class="hourglass-post-info">
            {{#if user}}
                <a href="/forum/user/{{user._id}}">
                    {{> avatar user=(user) size="small" shape="rounded" class="overview-avatar"}}
                </a>
                <a class="username" href="/forum/user/{{user._id}}">
                    {{user.username}}
                </a>
            {{/if}}
            <span>
                {{age}}
            </span>
        </div>
        {{#if hasContent}}
            <div class="post-content">
            </div>
        {{/if}}
    </div>
</template>
